<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Project 1: Prokudin-Gorskii Image Alignment</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>Project 1: Prokudin-Gorskii Image Alignment</h1>
            <p class="author">Nicolas LEDUC</p>
        </header>

        <section>
            <h2>Overview</h2>
            <p>The goal of this project is to take the digitized glass plate negatives from Sergei Prokudin-Gorskii's collection and automatically produce a color photograph. Each negative consists of three grayscale exposures (Blue, Green, and Red) stacked vertically. The core task is to split these channels and align them to reconstruct the original color image.</p>
        </section>

        <section>
            <h2>My Approach</h2>
            <p>To align the channels, I implemented a multi-scale image pyramid algorithm. This coarse-to-fine approach is efficient, especially for the high-resolution <code>.tif</code> images. Here's a breakdown of the process:</p>
            <ol>
                <li><strong>Channel Splitting:</strong> The input image is divided into three equal vertical parts, corresponding to the Blue, Green, and Red channels.</li>
                <li><strong>Image Pyramid Alignment:</strong> A recursive function builds an image pyramid for the B, G, and R channels. It finds the optimal displacement at the coarsest scale and progressively refines this estimate at finer scales. This avoids a prohibitively slow exhaustive search on the full-resolution image.</li>
                <li><strong>Similarity Metric:</strong> The Sum of Squared Differences (SSD) is used to score how well two channels match at a given displacement. To improve accuracy, the metric is calculated on the central 60% of the image, ignoring the noisy borders.</li>
            </ol>
        </section>

        <section>
            <h2>Bells & Whistles</h2>
            <ul>
                <li><strong>Automatic Contrast:</strong> The image's intensity values are stretched to enhance visual contrast. This is done by mapping the 2nd and 98th percentiles of pixel brightness to black and white, respectively, which makes the adjustment robust to outlier pixels.</li>
                <li><strong>Automatic White Balance:</strong> I used the "gray world" algorithm, which assumes the average color of a scene is gray. It scales the R, G, and B channels so their average intensities are equal, correcting for color casts.</li>
                <li><strong>Automatic Cropping:</strong> To remove the distracting colored borders caused by misalignment, a simple 5% border is cropped from all sides of the final image.</li>
            </ul>
        </section>
        
        <section>
            <h2>Results Gallery</h2>
<div class="gallery">
    <div class="result-item">
        <h3>cathedral.jpg</h3>
        <img src="output/cathedral_aligned.jpg" alt="Aligned image of a cathedral">
        <p><strong>Displacements:</strong> G(y,x) = (5, 2), R(y,x) = (12, 3)</p>
    </div>
    <div class="result-item">
        <h3>church.tif</h3>
        <img src="output/church_aligned.jpg" alt="Aligned image of a church">
        <p><strong>Displacements:</strong> G(y,x) = (25, 4), R(y,x) = (58, -4)</p>
    </div>
    <div class="result-item">
        <h3>emir.tif</h3>
        <img src="output/emir_aligned.jpg" alt="Aligned image of the Emir of Bukhara">
        <p><strong>Displacements:</strong> G(y,x) = (49, 24), R(y,x) = (61, 43)</p>
    </div>
    <div class="result-item">
        <h3>harvesters.tif</h3>
        <img src="output/harvesters_aligned.jpg" alt="Aligned image of harvesters">
        <p><strong>Displacements:</strong> G(y,x) = (59, 17), R(y,x) = (123, 14)</p>
    </div>
    <div class="result-item">
        <h3>icon.tif</h3>
        <img src="output/icon_aligned.jpg" alt="Aligned image of an icon">
        <p><strong>Displacements:</strong> G(y,x) = (41, 17), R(y,x) = (89, 23)</p>
    </div>
    <div class="result-item">
        <h3>italil.tif</h3>
        <img src="output/italil_aligned.jpg" alt="Aligned image of italil">
        <p><strong>Displacements:</strong> G(y,x) = (38, 21), R(y,x) = (77, 35)</p>
    </div>
    <div class="result-item">
        <h3>lastochikino.tif</h3>
        <img src="output/lastochikino_aligned.jpg" alt="Aligned image of lastochikino">
        <p><strong>Displacements:</strong> G(y,x) = (-3, -2), R(y,x) = (75, -9)</p>
    </div>
    <div class="result-item">
        <h3>lugano.tif</h3>
        <img src="output/lugano_aligned.jpg" alt="Aligned image of lugano">
        <p><strong>Displacements:</strong> G(y,x) = (41, -16), R(y,x) = (93, -29)</p>
    </div>
    <div class="result-item">
        <h3>melons.tif</h3>
        <img src="output/melons_aligned.jpg" alt="Aligned image of melons">
        <p><strong>Displacements:</strong> G(y,x) = (81, 10), R(y,x) = (178, 14)</p>
    </div>
    <div class="result-item">
        <h3>monastery.jpg</h3>
        <img src="output/monastery_aligned.jpg" alt="Aligned image of a monastery">
        <p><strong>Displacements:</strong> G(y,x) = (-3, 2), R(y,x) = (3, 2)</p>
    </div>
    <div class="result-item">
        <h3>self_portrait.tif</h3>
        <img src="output/self_portrait_aligned.jpg" alt="Aligned self portrait of Prokudin-Gorskii">
        <p><strong>Displacements:</strong> G(y,x) = (78, 29), R(y,x) = (176, 37)</p>
    </div>
    <div class="result-item">
        <h3>siren.tif</h3>
        <img src="output/siren_aligned.jpg" alt="Aligned image of siren">
        <p><strong>Displacements:</strong> G(y,x) = (50, -5), R(y,x) = (97, -24)</p>
    </div>
    <div class="result-item">
        <h3>three_generations.tif</h3>
        <img src="output/three_generations_aligned.jpg" alt="Aligned image of three generations">
        <p><strong>Displacements:</strong> G(y,x) = (52, 14), R(y,x) = (111, 12)</p>
    </div>
    <div class="result-item">
        <h3>tobolsk.jpg</h3>
        <img src="output/tobolsk_aligned.jpg" alt="Aligned image of tobolsk">
        <p><strong>Displacements:</strong> G(y,x) = (3, 3), R(y,x) = (7, 3)</p>
    </div>
</div>
            <div class="comparison-gallery">

    <div class="comparison-item">
        <h3>cathedral.jpg</h3>
        <div class="image-pair">
            <figure>
                <img src="data/cathedral.jpg" alt="Unaligned cathedral image plate">
                <figcaption>Before (Raw Plate)</figcaption>
            </figure>
            <figure>
                <img src="output/cathedral_aligned.jpg" alt="Aligned and corrected cathedral image">
                <figcaption>After (Aligned & Corrected)</figcaption>
            </figure>
        </div>
        <p class="displacement-info"><strong>Displacements:</strong> G(y,x) = (5, 2), R(y,x) = (12, 3)</p>
    </div>

    <div class="comparison-item">
        <h3>church.tif</h3>
        <div class="image-pair">
            <figure>
                <img src="data/church.tif" alt="Unaligned church image plate">
                <figcaption>Before (Raw Plate)</figcaption>
            </figure>
            <figure>
                <img src="output/church_aligned.jpg" alt="Aligned and corrected church image">
                <figcaption>After (Aligned & Corrected)</figcaption>
            </figure>
        </div>
        <p class="displacement-info"><strong>Displacements:</strong> G(y,x) = (25, 4), R(y,x) = (58, -4)</p>
    </div>

    <div class="comparison-item">
        <h3>emir.tif</h3>
        <div class="image-pair">
            <figure>
                <img src="data/emir.tif" alt="Unaligned emir image plate">
                <figcaption>Before (Raw Plate)</figcaption>
            </figure>
            <figure>
                <img src="output/emir_aligned.jpg" alt="Aligned and corrected emir image">
                <figcaption>After (Aligned & Corrected)</figcaption>
            </figure>
        </div>
        <p class="displacement-info"><strong>Displacements:</strong> G(y,x) = (49, 24), R(y,x) = (61, 43)</p>
    </div>

    <div class="comparison-item">
        <h3>harvesters.tif</h3>
        <div class="image-pair">
            <figure>
                <img src="data/harvesters.tif" alt="Unaligned harvesters image plate">
                <figcaption>Before (Raw Plate)</figcaption>
            </figure>
            <figure>
                <img src="output/harvesters_aligned.jpg" alt="Aligned and corrected harvesters image">
                <figcaption>After (Aligned & Corrected)</figcaption>
            </figure>
        </div>
        <p class="displacement-info"><strong>Displacements:</strong> G(y,x) = (59, 17), R(y,x) = (123, 14)</p>
    </div>

    <div class="comparison-item">
        <h3>icon.tif</h3>
        <div class="image-pair">
            <figure>
                <img src="data/icon.tif" alt="Unaligned icon image plate">
                <figcaption>Before (Raw Plate)</figcaption>
            </figure>
            <figure>
                <img src="output/icon_aligned.jpg" alt="Aligned and corrected icon image">
                <figcaption>After (Aligned & Corrected)</figcaption>
            </figure>
        </div>
        <p class="displacement-info"><strong>Displacements:</strong> G(y,x) = (41, 17), R(y,x) = (89, 23)</p>
    </div>

    <div class="comparison-item">
        <h3>italil.tif</h3>
        <div class="image-pair">
            <figure>
                <img src="data/italil.tif" alt="Unaligned italil image plate">
                <figcaption>Before (Raw Plate)</figcaption>
            </figure>
            <figure>
                <img src="output/italil_aligned.jpg" alt="Aligned and corrected italil image">
                <figcaption>After (Aligned & Corrected)</figcaption>
            </figure>
        </div>
        <p class="displacement-info"><strong>Displacements:</strong> G(y,x) = (38, 21), R(y,x) = (77, 35)</p>
    </div>

    <div class="comparison-item">
        <h3>lastochikino.tif</h3>
        <div class="image-pair">
            <figure>
                <img src="data/lastochikino.tif" alt="Unaligned lastochikino image plate">
                <figcaption>Before (Raw Plate)</figcaption>
            </figure>
            <figure>
                <img src="output/lastochikino_aligned.jpg" alt="Aligned and corrected lastochikino image">
                <figcaption>After (Aligned & Corrected)</figcaption>
            </figure>
        </div>
        <p class="displacement-info"><strong>Displacements:</strong> G(y,x) = (-3, -2), R(y,x) = (75, -9)</p>
    </div>

    <div class="comparison-item">
        <h3>lugano.tif</h3>
        <div class="image-pair">
            <figure>
                <img src="data/lugano.tif" alt="Unaligned lugano image plate">
                <figcaption>Before (Raw Plate)</figcaption>
            </figure>
            <figure>
                <img src="output/lugano_aligned.jpg" alt="Aligned and corrected lugano image">
                <figcaption>After (Aligned & Corrected)</figcaption>
            </figure>
        </div>
        <p class="displacement-info"><strong>Displacements:</strong> G(y,x) = (41, -16), R(y,x) = (93, -29)</p>
    </div>

    <div class="comparison-item">
        <h3>melons.tif</h3>
        <div class="image-pair">
            <figure>
                <img src="data/melons.tif" alt="Unaligned melons image plate">
                <figcaption>Before (Raw Plate)</figcaption>
            </figure>
            <figure>
                <img src="output/melons_aligned.jpg" alt="Aligned and corrected melons image">
                <figcaption>After (Aligned & Corrected)</figcaption>
            </figure>
        </div>
        <p class="displacement-info"><strong>Displacements:</strong> G(y,x) = (81, 10), R(y,x) = (178, 14)</p>
    </div>

    <div class="comparison-item">
        <h3>monastery.jpg</h3>
        <div class="image-pair">
            <figure>
                <img src="data/monastery.jpg" alt="Unaligned monastery image plate">
                <figcaption>Before (Raw Plate)</figcaption>
            </figure>
            <figure>
                <img src="output/monastery_aligned.jpg" alt="Aligned and corrected monastery image">
                <figcaption>After (Aligned & Corrected)</figcaption>
            </figure>
        </div>
        <p class="displacement-info"><strong>Displacements:</strong> G(y,x) = (-3, 2), R(y,x) = (3, 2)</p>
    </div>

    <div class="comparison-item">
        <h3>self_portrait.tif</h3>
        <div class="image-pair">
            <figure>
                <img src="data/self_portrait.tif" alt="Unaligned self_portrait image plate">
                <figcaption>Before (Raw Plate)</figcaption>
            </figure>
            <figure>
                <img src="output/self_portrait_aligned.jpg" alt="Aligned and corrected self_portrait image">
                <figcaption>After (Aligned & Corrected)</figcaption>
            </figure>
        </div>
        <p class="displacement-info"><strong>Displacements:</strong> G(y,x) = (78, 29), R(y,x) = (176, 37)</p>
    </div>

    <div class="comparison-item">
        <h3>siren.tif</h3>
        <div class="image-pair">
            <figure>
                <img src="data/siren.tif" alt="Unaligned siren image plate">
                <figcaption>Before (Raw Plate)</figcaption>
            </figure>
            <figure>
                <img src="output/siren_aligned.jpg" alt="Aligned and corrected siren image">
                <figcaption>After (Aligned & Corrected)</figcaption>
            </figure>
        </div>
        <p class="displacement-info"><strong>Displacements:</strong> G(y,x) = (50, -5), R(y,x) = (97, -24)</p>
    </div>

    <div class="comparison-item">
        <h3>three_generations.tif</h3>
        <div class="image-pair">
            <figure>
                <img src="data/three_generations.tif" alt="Unaligned three_generations image plate">
                <figcaption>Before (Raw Plate)</figcaption>
            </figure>
            <figure>
                <img src="output/three_generations_aligned.jpg" alt="Aligned and corrected three_generations image">
                <figcaption>After (Aligned & Corrected)</figcaption>
            </figure>
        </div>
        <p class="displacement-info"><strong>Displacements:</strong> G(y,x) = (52, 14), R(y,x) = (111, 12)</p>
    </div>

    <div class="comparison-item">
        <h3>tobolsk.jpg</h3>
        <div class="image-pair">
            <figure>
                <img src="data/tobolsk.jpg" alt="Unaligned tobolsk image plate">
                <figcaption>Before (Raw Plate)</figcaption>
            </figure>
            <figure>
                <img src="output/tobolsk_aligned.jpg" alt="Aligned and corrected tobolsk image">
                <figcaption>After (Aligned & Corrected)</figcaption>
            </figure>
        </div>
        <p class="displacement-info"><strong>Displacements:</strong> G(y,x) = (3, 3), R(y,x) = (7, 3)</p>
    </div>

</div>
        </section>
        <footer>
            <p>&copy; 2025 Nicolas Leduc. All rights reserved.</p>
        </footer>
    </div>
        <script src="script.js" defer></script>
</body>
</html>
